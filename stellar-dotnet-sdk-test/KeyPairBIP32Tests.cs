using Microsoft.VisualStudio.TestTools.UnitTesting;
using stellar_dotnet_sdk;
using dotnetstandard_bip32;

using System;
using System.Collections.Generic;
using System.Text;

namespace stellar_dotnet_sdk_test
{
    [TestClass]
    public class KeyPairBIP39Tests
    {

        [TestMethod]
        public void TestCase1()
        {
            var TestCase1Bip39Seed = "e4a5a632e70943ae7f07659df1332160937fad82587216a4c64315a0fb39497ee4a01f76ddab4cba68147977f3a147b6ad584c41808e8238a07f6cc4b582f186";

            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 0, "GDRXE2BQUC3AZNPVFSCEZ76NJ3WWL25FYFK6RGZGIEKWE4SOOHSUJUJ6", "SBGWSG6BTNCKCOB3DIFBGCVMUPQFYPA2G4O34RMTB343OYPXU5DJDVMN");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 1, "GBAW5XGWORWVFE2XTJYDTLDHXTY2Q2MO73HYCGB3XMFMQ562Q2W2GJQX", "SCEPFFWGAG5P2VX5DHIYK3XEMZYLTYWIPWYEKXFHSK25RVMIUNJ7CTIS");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 2, "GAY5PRAHJ2HIYBYCLZXTHID6SPVELOOYH2LBPH3LD4RUMXUW3DOYTLXW", "SDAILLEZCSA67DUEP3XUPZJ7NYG7KGVRM46XA7K5QWWUIGADUZCZWTJP");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 3, "GAOD5NRAEORFE34G5D4EOSKIJB6V4Z2FGPBCJNQI6MNICVITE6CSYIAE", "SBMWLNV75BPI2VB4G27RWOMABVRTSSF7352CCYGVELZDSHCXWCYFKXIX");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 4, "GBCUXLFLSL2JE3NWLHAWXQZN6SQC6577YMAU3M3BEMWKYPFWXBSRCWV4", "SCPCY3CEHMOP2TADSV2ERNNZBNHBGP4V32VGOORIEV6QJLXD5NMCJUXI");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 5, "GBRQY5JFN5UBG5PGOSUOL4M6D7VRMAYU6WW2ZWXBMCKB7GPT3YCBU2XZ", "SCK27SFHI3WUDOEMJREV7ZJQG34SCBR6YWCE6OLEXUS2VVYTSNGCRS6X");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 6, "GBY27SJVFEWR3DUACNBSMJB6T4ZPR4C7ZXSTHT6GMZUDL23LAM5S2PQX", "SDJ4WDPOQAJYR3YIAJOJP3E6E4BMRB7VZ4QAEGCP7EYVDW6NQD3LRJMZ");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 7, "GAY7T23Z34DWLSTEAUKVBPHHBUE4E3EMZBAQSLV6ZHS764U3TKUSNJOF", "SA3HXJUCE2N27TBIZ5JRBLEBF3TLPQEBINP47E6BTMIWW2RJ5UKR2B3L");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 8, "GDJTCF62UUYSAFAVIXHPRBR4AUZV6NYJR75INVDXLLRZLZQ62S44443R", "SCD5OSHUUC75MSJG44BAT3HFZL2HZMMQ5M4GPDL7KA6HJHV3FLMUJAME");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 9, "GBTVYYDIYWGUQUTKX6ZMLGSZGMTESJYJKJWAATGZGITA25ZB6T5REF44", "SCJGVMJ66WAUHQHNLMWDFGY2E72QKSI3XGSBYV6BANDFUFE7VY4XNXXR");
        }

        [TestMethod]
        public void TestCase2()
        {
            var TestCase1Bip39Seed = "7b36d4e725b48695c3ffd2b4b317d5552cb157c1a26c46d36a05317f0d3053eb8b3b6496ba39ebd9312d10e3f9937b47a6790541e7c577da027a564862e92811";

            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 0, "GAVXVW5MCK7Q66RIBWZZKZEDQTRXWCZUP4DIIFXCCENGW2P6W4OA34RH", "SAKS7I2PNDBE5SJSUSU2XLJ7K5XJ3V3K4UDFAHMSBQYPOKE247VHAGDB");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 1, "GDFCYVCICATX5YPJUDS22KM2GW5QU2KKSPPPT2IC5AQIU6TP3BZSLR5K", "SAZ2H5GLAVWCUWNPQMB6I3OHRI63T2ACUUAWSH7NAGYYPXGIOPLPW3Q4");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 2, "GAUA3XK3SGEQFNCBM423WIM5WCZ4CR4ZDPDFCYSFLCTODGGGJMPOHAAE", "SDVSSLPL76I33DKAI4LFTOAKCHJNCXUERGPCMVFT655Z4GRLWM6ZZTSC");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 3, "GAH3S77QXTAPZ77REY6LGFIJ2XWVXFOKXHCFLA6HQTL3POLVZJDHHUDM", "SCH56YSGOBYVBC6DO3ZI2PY62GBVXT4SEJSXJOBQYGC2GCEZSB5PEVBZ");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 4, "GCSCZVGV2Y3EQ2RATJ7TE6PVWTW5OH5SMG754AF6W6YM3KJF7RMNPB4Y", "SBWBM73VUNBGBMFD4E2BA7Q756AKVEAAVTQH34RYEUFD6X64VYL5KXQ2");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 5, "GDKWYAJE3W6PWCXDZNMFNFQSPTF6BUDANE6OVRYMJKBYNGL62VKKCNCC", "SAVS4CDQZI6PSA5DPCC42S5WLKYIPKXPCJSFYY4N3VDK25T2XX2BTGVX");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 6, "GCDTVB4XDLNX22HI5GUWHBXJFBCPB6JNU6ZON7E57FA3LFURS74CWDJH", "SDFC7WZT3GDQVQUQMXN7TC7UWDW5E3GSMFPHUT2TSTQ7RKWTRA4PLBAL");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 7, "GBTDPL5S4IOUQHDLCZ7I2UXJ2TEHO6DYIQ3F2P5OOP3IS7JSJI4UMHQJ", "SA6UO2FIYC6AS2MSDECLR6F7NKCJTG67F7R4LV2GYB4HCZYXJZRLPOBB");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 8, "GD3KWA24OIM7V3MZKDAVSLN3NBHGKVURNJ72ZCTAJSDTF7RIGFXPW5FQ", "SBDNHDDICLLMBIDZ2IF2D3LH44OVUGGAVHQVQ6BZQI5IQO6AB6KNJCOV");
            BIP39Assert.AssertDerivedAccount(TestCase1Bip39Seed, 9, "GB3C6RRQB3V7EPDXEDJCMTS45LVDLSZQ46PTIGKZUY37DXXEOAKJIWSV", "SDHRG2J34MGDAYHMOVKVJC6LX2QZMCTIKRO5I4JQ6BJQ36KVL6QUTT72");
        }


        private static class BIP39Assert
        {
            public static void AssertDerivedAccount(string bip39Seed, int accountIndex, string expectedAccountId, string expectedSecret)
            {

                KeyPair pair = KeyPair.FromBIP39Seed(bip39Seed, accountIndex);
                Assert.AreEqual(expectedAccountId, pair.AccountId);
                Assert.AreEqual(expectedSecret, pair.SecretSeed);
            }
        }

    }


}
